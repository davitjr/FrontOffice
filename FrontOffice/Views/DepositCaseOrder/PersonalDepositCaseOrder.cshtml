@{
    Layout = null;
}
<div id="depositCaseOrderLoad" class="overlay hidden">
    <img class="loader-image non-selectable" src="../../Content/Images/invisible.png" />
</div>
<form ng-controller="DepositCaseOrderCtrl" name="DepositCaseOrderOrderForm" id="DepositCaseOrderOrderForm" role="form" style="min-width:650px;" novalidate class="form-horizontal" labels-required>
    <div id="newaccount_menu" class="menu-bar dialog-menu light-green">
        <ul id="menu" class="dialog-menu">
            <li ng-if="orderType==99 && order.DepositCase" class="root-menu-item-3 " ng-click="getDepositCaseContract(order.DepositCase.ProductId)">
                <span id="h-menu-item-3"><img id="h-menu-icon-3" class="h-menu-icon applicationButton">Պայմանագիր</span>
            </li>
            <li ng-if="(orderType==99 || orderType==101) && order.DepositCase" class="root-menu-item-3 " ng-click="printOrder(order.DepositCase.ProductId)">
                <span id="h-menu-item-3"><img id="h-menu-icon-3" class="h-menu-icon applicationButton">Հանձնարարական</span>
            </li>
            <li ng-if="orderType==101 && order.DepositCase" class="root-menu-item-3 " ng-click="getDepositCaseCloseContract(order.DepositCase.ProductId)">
                <span id="h-menu-item-3"><img id="h-menu-icon-3" class="h-menu-icon applicationButton">Դիմում</span>
            </li>
            <li class="root-menu-item-4 " ng-click="DepositCaseOrderOrderForm.$setSubmitted();DepositCaseOrderOrderForm.$valid && saveDepositCaseOrder()">
                <span id="h-menu-item-4"><img id="h-menu-icon-4" class="submitButton h-menu-icon">Պահպանել</span>
            </li>
            <li class="root-menu-item-5 " onclick="CloseBPDialog('newDepositCaseOrder')">
                <span id="h-menu-item-5"><img id="h-menu-icon-5" class="h-menu-icon cancelButton">Հրաժարվել</span>
            </li>
        </ul>
        <div id="right-menu" style="display:none;">
        </div>
    </div>

    <div style="max-width:530px">
        <errors></errors>
    </div>

    <div class="col-sm-10">





        <div class=" form-group">
            <label class="tab_title col-sm-5 " for="RegistrationDate">Մուտքագրման ա/թ</label>
            <div class="col-sm-6 row">
                <div class="multiple_columns col-sm-8 ">
                    <input disabled="disabled" type="date" class="form-control tab_title unstyled" style="text-align: left;" id="RegistrationDate" name="RegistrationDate" ng-model="order.OperationDate" required>
                </div>
            </div>
        </div>
        <div class=" form-group" ng-init="orderType==98? getDepositCaseOrderContractNumber():''">
            <label class="tab_title col-sm-5 " for="ContractNumber">Պայմանագրի համար</label>
            <div class="col-sm-6">
                <div class="row">
                    <div class="multiple_columns col-sm-8 ">
                        <input type="number" ng-disabled="orderType==101 || orderType==99" class="form-control tab_title unstyled" style="text-align: left;" id="ContractNumber" name="ContractNumber" ng-model="order.DepositCase.ContractNumber" required>
                    </div>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.ContractNumber.$dirty"
                                 for="DepositCaseOrderOrderForm.ContractNumber.$error">
                        <ng-message when="required" class="errors">
                            Պայմանագրի համարը լրացված չէ
                        </ng-message>
                    </ng-messages>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="tab_title col-sm-5" for="JointType">{{labelName}}</label>
            <div class="col-sm-6">
                <div class="row" ng-init="order.DepositCase.JointType!=1?labelName='Ոչ համատեղ':labelName='Համատեղ'">
                    <input type="checkbox" ng-disabled="orderType==101 || orderType==99" class="checkbox-inline" id="JointType" ng-model="order.DepositCase.JointType" ng-change="order.DepositCase.JointType==1?labelName='Համատեղ':labelName='Ոչ համատեղ';order.DepositCase.JointType==0?order.DepositCase.JointCustomers = []:''" ng-true-value="1" ng-false-value="0">
                </div>

            </div>
        </div>

        

        <div class="form-group" ng-if="order.DepositCase.JointType==1">
            <label class="tab_title col-sm-5" for="ContractType"> Պայմանագրի տեսակ</label>
            <div class="col-sm-6">
                <div class="row">
                    <loading-control scopevariable="contractTypes"></loading-control>
                    <select ng-model="order.DepositCase.ContractType" ng-disabled="orderType==101 || orderType==99" ng-show="contractTypes" name="ContractType" id="ContractType" class="form-control" required
                            data-ng-options="k as v for (k,v) in contractTypes">

                        <option value="" hidden="hidden" style=" margin-left:25px">Ընտրեք տեսակը...</option>

                    </select>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.ContractType.$dirty"
                                 for="DepositCaseOrderOrderForm.ContractType.$error">
                        <ng-message when="required" class="errors">
                            Պայմանագրի տեսակը ընտրված չէ
                        </ng-message>
                    </ng-messages>
                </div>
            </div>
        </div>
        <div class="form-group" ng-if="order.DepositCase.JointType==1 && orderType!=101">
            <label class="col-sm-5 tab_title">Պահատու 2</label>
            <div class="col-sm-6 ">
                <div class="row">
                    <div class="input-group">
                        <input type="text" ng-model="customerNumber" ng-disabled="orderType==101 || orderType==99" style="width:122px" onkeypress='return event.charCode >= 48 && event.charCode <= 57' maxlength="12" class="form-control" id="customerNumber" name="customerNumber" required ng-model-options="{updateOn: 'blur'}" data-update-model-on-enter-key-pressed>
                        <div class="input-group-btn" style="display:inline-block;">
                            <button type="button" ng-disabled="orderType==101 || orderType==99" title="Ավելացնել հաճախորդին" class="btn btn-primary" ng-click="addCustomer(customerNumber)"><span class="glyphicon glyphicon-plus"></span></button>
                            <button type="button" ng-disabled="orderType==101 || orderType==99" title="Հաճախորդի որոնոմ" class="btn btn-primary searchButton" ng-click="searchCustomers()"><span class="glyphicon glyphicon-search greenStyle"></span></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group" ng-if="order.DepositCase.JointType==1">
            <div class="col-sm-6" ng-repeat="CustomerNumber in order.DepositCase.JointCustomers" ng-if="order.DepositCase.JointCustomers.length>0">
                <div class="row" style="margin-left:10px;">
                    <button type="button" ng-disabled="orderType==101 || orderType==99" class="btn btn-danger btn-xs" ng-click="delete($index)"><span class="glyphicon glyphicon-remove"></span></button>
                    <customerinfo customernumber="CustomerNumber.key" showfulldata="false"> </customerinfo>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label class="tab_title col-sm-5" for="RecontractPossibility" ng-init="order.DepositCase.RecontractPossibility=order.DepositCase.RecontractPossibility.toString()">Ավտոմատ երկարաձգում</label>
            <div class="col-sm-6">
                <div class="row">
                    <select data-ng-model="order.DepositCase.RecontractPossibility" ng-disabled="orderType==101 || orderType==99" name="RecontractPossibility" id="RecontractPossibility"  class="form-control" required>
                        <option value="" hidden="hidden" style="margin-left:25px">Ընտրեք ...</option>
                        <option value="true">Այո</option>
                        <option value="false">Ոչ</option>
                    </select>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.RecontractPossibility.$dirty"
                                 for="DepositCaseOrderOrderForm.RecontractPossibility.$error">
                        <ng-message when="required" class="errors">
                            Ավտոմատ երկարաձգման տեսակն ընտրված չէ
                        </ng-message>
                    </ng-messages>
                </div>

            </div>
        </div>

        <div class="form-group">
            <label class="tab_title col-sm-5" for="CaseContractDays"> Պայմանագրի ժամկետ</label>
            <div class="col-sm-6" data-ng-init="getDepositCaseContractDays()">
                <div class="row">
                    <loading-control scopevariable="caseContractDays"></loading-control>
                    <select ng-model="order.DepositCase.ContractDuration" ng-disabled="orderType==99 || orderType==101" ng-show="caseContractDays" name="CaseContractDays" id="CaseContractDays" ng-change="isSunDay()" class="form-control" required
                            data-ng-options="k as v for (k,v) in caseContractDays">

                        <option value="" hidden="hidden" style="margin-left:25px">Ընտրեք ժամկետը...</option>

                    </select>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.CaseContractDays.$dirty"
                                 for="DepositCaseOrderOrderForm.CaseContractDays.$error">
                        <ng-message when="required" class="errors">
                            Պայմանագրի ժամկետը ընտրված չէ
                        </ng-message>
                    </ng-messages>
                </div>
            </div>
        </div>

        <div class=" form-group">
            <label class="tab_title col-sm-5 " for="ContractDate">Պայմանագրի սկիզբ</label>
            <div class="col-sm-6 ">
                <div class="row">
                    <input type="date" class="form-control tab_title" ng-disabled="orderType==101 || orderType==99" style="text-align: left;" id="StartDate" name="StartDate" ng-blur="isSunDay()" ng-model="order.DepositCase.StartDate" required>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.StartDate.$dirty"
                                 for="DepositCaseOrderOrderForm.StartDate.$error">
                        <ng-message when="required" class="errors">
                            Պայմանագրի սկիզբ լրացված չէ
                        </ng-message>
                    </ng-messages>
                </div>
            </div>
        </div>
        <div class=" form-group">
            <label class="tab_title col-sm-5 " for="DateOfNormalEnd">Պայմանագրի վերջ</label>
            <div class="col-sm-6 ">
                <div class="row">
                    <input type="date" class="form-control tab_title " disabled="disabled" style="text-align: left;" id="EndDate" name="EndDate" ng-model="order.DepositCase.EndDate" required>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.EndDate.$dirty"
                                 for="DepositCaseOrderOrderForm.EndDate.$error">
                        <ng-message when="required" class="errors">
                            Պայմանագրի վերջ լրացված չէ
                        </ng-message>
                    </ng-messages>
                </div>
            </div>
        </div>
        
        
        <style>
            #caseNumber .dropdown-menu > li > a {
                display: initial !important
            }
        </style>
        <div class=" form-group" id="caseNumber">
            <label class="tab_title col-sm-5 " for="CaseNumber">Պահատուփի համար</label>
            <div class="col-sm-6">
                <div class="row">
                    <div class="input-group">
                        <input type="text"disabled="disabled" style="width:122px" class="form-control tab_title unstyled" onkeypress='return event.charCode >= 48 && event.charCode <= 57' id="CaseNumber" name="CaseNumber" ng-model="order.DepositCase.CaseNumber" required>
                        <div class="input-group-btn" style="display:inline-block;">
                            <button ng-if="userFilialCode!=22041" ng-disabled="orderType==101 || orderType==99" title="Պահատուփերի քարտեզ" ng-controller="PopUpCtrl" ng-click="params={userFilialCode:$parent.userFilialCode,caseSide:0,caseorder:order}; openWindow('/DepositCaseOrder/DepositCaseMap','Պահատուփերի քարտեզ','depositCaseMap')" type="button" class="btn btn-primary searchButton"><span class="glyphicon glyphicon-th greenStyle"></span></button>
                            <button ng-if="userFilialCode==22041" ng-disabled="orderType==101 || orderType==99" class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <span class="glyphicon glyphicon-th"></span>
                                <span class="caret"></span>
                            </button>
                            <ul class="dropdown-menu" aria-labelledby="dropdownMenu2">
                                <li style=" cursor: pointer;" ng-disabled="orderType==101 || orderType==99" ng-controller="PopUpCtrl" ng-click="params={userFilialCode:$parent.userFilialCode,caseSide:2,caseorder:order}; openWindow('/DepositCaseOrder/DepositCaseMap','Պահատուփերի քարտեզ','depositCaseMap')"><a>Ձախ պահատուփերի քարտեզ</a></li>
                                <li style=" cursor: pointer;" ng-disabled="orderType==101 || orderType==99" ng-controller="PopUpCtrl" ng-click="params={userFilialCode:$parent.userFilialCode,caseSide:1,caseorder:order};openWindow('/DepositCaseOrder/DepositCaseMap','Պահատուփերի քարտեզ','depositCaseMap')"><a>Աջ պահատուփերի քարտեզ</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.CaseNumber.$dirty"
                                 for="DepositCaseOrderOrderForm.CaseNumber.$error">
                        <ng-message when="required" class="errors">
                            Պահատուփի համարը լրացված չէ
                        </ng-message>
                    </ng-messages>
                </div>
            </div>
        </div>

        
        <usersetnumber setnumber="order.DepositCase.ServicingSetNumber" disabled="orderType==101 || orderType==99" formname="DepositCaseOrderOrderForm" labelname="Սպասարկողի ՊԿ"></usersetnumber>
        

        <paymentaccount ng-if="orderType==99"
                        data-ng-init="getAccounts()"
                        accounts="connectAccounts"
                        accountselectname="ConnectAccount"
                        account="order.DepositCase.ConnectAccount"
                        check="0"
                        nameforaccount="'Ընթացիք հաշիվ'"
                        nameforcurrency=""
                        formname="DepositCaseOrderOrderForm">
        </paymentaccount>
        <div class="row">
            <div class="col-sm-5"></div>
            <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || exchangeOrderForm.ConnectAccount.$dirty"
                         for="DepositCaseOrderOrderForm.ConnectAccount.$error">
                <ng-message when="required" class="errors">
                    Ընթացիք հաշիվը լրացված չէ
                </ng-message>
            </ng-messages>
        </div>

        <div class="form-group" ng-show="orderType==99 && order.DepositCase">
            <label class="tab_title col-sm-5 " for="feeAccount" ng-init="cashType=24">Միջնորդավճարի գանձում</label>
            <div class="col-sm-6 ">
                <div class="row">
                    <select data-ng-model="cashType" name="Fee" id="Fee" class=" form-control" required>
                        <option value="" hidden></option>
                        <option value="24" selected="selected">Անկանխիկ</option>
                        <option value="23">Կանխիկ</option>
                    </select>
                </div>
            </div>
        </div>

        <paymentaccount ng-if="orderType==99 && cashType==24"
                        data-ng-init="getFeeAccounts()"
                        accounts="feeAccounts"
                        accountselectname="FeeAccount"
                        account="order.FeeAccount"
                        check="0"
                        nameforaccount="'Միջնորդավճարի հաշիվ'"
                        nameforcurrency=""
                        formname="DepositCaseOrderOrderForm">
        </paymentaccount>
        <div class="row">
            <div class="col-sm-5"></div>
            <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.FeeAccount.$dirty"
                         for="DepositCaseOrderOrderForm.FeeAccount.$error">
                <ng-message when="required" class="errors">
                    Միջնորդավճարի հաշիվը լրացված չէ
                </ng-message>
            </ng-messages>
        </div>
        <div class="form-group" ng-if="orderType==99 && order.DepositCase">
            <label class="tab_title col-sm-5" for="Amount">Գումար</label>
            <div class="col-sm-6 row">
                <div class="input-group col-sm-10" ng-init="getDepositCasePrice()">
                    <input type="text" disabled="disabled" required onkeypress='return event.charCode >= 48 && event.charCode <= 57 || event.charCode==46' ng-model="order.Amount" id="Amount" name="Amount" class="form-control tab_title" fcsa-number />
                    <span class="input-group-addon" id="basic-addon2" style=" width: 0;"> AMD </span>
                </div>
                <div class="row">
                    <ng-messages ng-if="DepositCaseOrderOrderForm.$submitted || DepositCaseOrderOrderForm.Amount.$dirty"
                                 for="DepositCaseOrderOrderForm.Amount.$error">
                        <ng-message when="required" class="errors">
                            Գումար դաշտը լրացված չէ
                        </ng-message>

                        <ng-message when="fcsaNumber" class="errors">
                            Գումարը սխալ է մուտքագրված
                        </ng-message>
                    </ng-messages>
                </div>
            </div>
        </div>
        

        
    </div>

</form>











